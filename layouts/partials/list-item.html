<div class="item">

    {{ $.Scratch.Set "link" .RelPermalink }}
    {{ with .Params.repo }}
        {{ $repoHost := default "github" $.Params.repoHost }}
        {{ if eq "github" $repoHost }}
            {{ printf "https://github.com/%s/%s/" $.Site.Params.githubUsername . | $.Scratch.Set "link" }}
        {{ else if eq "gitlab" $repoHost }}
            {{ printf "https://gitlab.com/%s/%s/" $.Site.Params.gitlabUsername . | $.Scratch.Set "link" }}
        {{ else if eq "bitbucket" $repoHost }}
            {{ printf "https://bitbucket.org/%s/%s/" $.Site.Params.bitbucketUsername . | $.Scratch.Set "link" }}
        {{ end }}
    {{ end }}
    {{ with .Params.link }} {{ $.Scratch.Set "link" . }} {{ end }}
    {{ .Date.Format (.Site.Params.dateFormat | default "January 2, 2006") | $.Scratch.Set "subtitle" }}
    {{ with .Description }} {{ $.Scratch.Set "subtitle" . }} {{ end }}

    <video id="{{ .Params.id }}" onclick="this.paused ? this.play() : this.pause();" poster="{{ .Params.clip }}.jpg">
        <source src="{{ .Params.clip }}.webm" type="video/webm"> 
        <source src="{{ .Params.clip }}.mp4" type="video/mp4">
        
        I'm sorry; your browser doesn't support HTML5 video. Try updating your browser.
    </video>
    <h4 class="t1">{{ .Title }}</h4>
    <h5 class="subtitle">{{ $.Scratch.Get "subtitle" }}</h5>
</div>

<script type="text/javascript">
    (function(window) {
        function setupVideo()
        {
            var v = document.getElementById("{{ .Params.id }}");
            v.addEventListener('mouseover', function() { this.controls = true; }, false);
            v.addEventListener('mouseout', function() { this.controls = false; }, false);
        }

        window.addEventListener('load', setupVideo, false);
    })(window);
</script>